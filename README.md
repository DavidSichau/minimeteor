# MiniMeteor

Build a **_small_** Docker image from your Meteor application **_easily_**.

## Usage

```$ curl https://aedm.github.io/minimeteor/build.sh | sh -s```*```myDockerTag[s]```*

Just execute this in your project directory and it builds a Docker image. You don't need Meteor to be installed, only Docker.

#### ...or create a Dockerfile instead.

`FROM aedm/minimeteor`

And then run `$ docker build -t myDockerTag .`

## Okay, what's this?

MiniMeteor is an effort to simplify Docker image creation for Meteor projects. Right now it's in early stages, and works only with Meteor 1.4.2+, but the plan is to support every release from 1.3 above.

### Small Docker images for Meteor, really?

MiniMeteor's goal is to use as little overhead as possible. Here are some image sizes for the default Meteor application: (generated by `meteor create`)

Method | Compressed size on Docker Hub | Uncompressed size
--- | --- | ---
MiniMeteor via shell script | 20.0M | 65.3M
MiniMeteor via Dockerfile | 42.0M | 127.8M
[Meteor Launchpad](https://hub.docker.com/r/jshimko/meteor-launchpad/) by jshimko | 139M | 389.8M 

If you know about any other projects, please create an issue, and I'll include them in this table. Most projects I know about (eg. MeteorD and Meteor-Tupperware) are broken since Meteor 1.4.2. 

### How to run the Docker image?

`$ docker run -d -e ROOT_URL=... -e MONGO_URL=... -p 80:80 myDockerTag`

### How does it work?

The shell script version uses three passes to build the image:
 1. A Debian container builds the Meteor bundle, and copies it back to the hsot machine using Docker volumes.
 2. An Alpine bundle rebuilds the binary NPM packages, because Alpine's CRT isn't fully compatible with Debian's.
 3. The final build is copied into a new [alpine-node](https://hub.docker.com/r/mhart/alpine-node/) container.
 
The Dockerfile version uses a different approach. It installs Meteor and some build tools into a debian/slim container, builds the bundle, copies the Node.js executable from the Meteor installation into the project directory, and removes all tools.

### Which Node.js version does MiniMeteor use?

It detects and uses the exact same version that a given Meteor release uses.

 
